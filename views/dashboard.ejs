<% const keys = ["first_name", "last_name","email","age","role"];
%>
<!DOCTYPE html>
<html>

<head>
  <title>Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <%- include("../partials/navbar") %>
  <form id="login-form">
    <h1>hi</h1>
    <% keys.forEach(item=>{ %>
    <h1><%= user[item] %> </h1>
    <% }) %>
  </form>
  <%- user.role === "admin" ? include("../partials/add_user") : null %>
  <script>
    const addUserForm = document.querySelector("#addUserForm");
    const addUserFormHandler = async (e) => {
      e.preventDefault();
      console.log(addUserForm);
      const accessToken = '<%=user.accessToken%>';
      try {
        const formResponse = await axios.post("/api/user", {
          first_name: addUserForm.first_name.value,
          last_name: addUserForm.last_name.value,
          email: addUserForm.email.value,
          gender: addUserForm.gender.value,
          age: addUserForm.age.value,
          role: addUserForm.role.value,
        }, {
          headers: {
            authorization: `Bearer ${accessToken}`
          }
        });
        const addedUserData = await formResponse.data;
        console.log(addedUserData);
      } catch (error) {
        console.log(error);
      }
    }
    addUserForm.addEventListener("submit", addUserFormHandler);
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.1.3/axios.min.js"></script>
</body>

</html>